build:
  gpu: true
  cuda: "12.1"
  python_version: "3.10.6"
  python_packages:
    - torch
    - torchvision
    - torchaudio
    - torchsde
    - einops
    - transformers>=4.25.1
    - safetensors>=0.3.0
    - aiohttp
    - accelerate
    - pyyaml
    - Pillow
    - scipy
    - tqdm
    - psutil
    - spandrel
    - kornia>=0.7.1
    - websocket-client==1.6.3

    # tensorrt
    - onnx
    - tensorrt-cu12>=10.1.0
    - tensorrt-cu12_bindings>=10.1.0
    - tensorrt-cu12_libs>=10.1.0

    # fix for pydantic issues in cog
    # https://github.com/replicate/cog/issues/1623
    - albumentations==1.4.3

    # avif handling
    - pillow-avif-plugin
  run:
    - curl -o /usr/local/bin/pget -L "https://github.com/replicate/pget/releases/download/v0.8.1/pget_linux_x86_64" && chmod +x /usr/local/bin/pget
    - pip install onnxruntime-gpu --extra-index-url https://aiinfra.pkgs.visualstudio.com/PublicPackages/_packaging/onnxruntime-cuda-12/pypi/simple/
predict: "predict.py:Predictor"
